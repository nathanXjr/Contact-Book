<html>
  <head>
    <meta charset="UTF-8" />
    <title>Contact Book</title>
  </head>
  <body onload="fetchContacts()">
    <div id="table">Contacts loading...</div>
    <button id="refresh" type="button">Refresh</button>
    <button id="addContact" type="button">Add Contact</button>

    <script src="config.js"></script>

    <script>
      function fetchContacts() {
        const apiKey = localStorage.getItem("apiKey");
        if (!apiKey) {
          alert("Please enter your API key first");
          window.location.href = "api-key.html";
          return;
        }

        fetch(
          `${rootPath}controller/get-contacts/?apiKey=${encodeURIComponent(
            apiKey
          )}`
        )
          .then((response) => {
            if (!response.ok) throw new Error("API request failed");
            return response.json();
          })
          .then((data) => {
            console.log("Contacts:", data);
          })
          .catch((error) => {
            console.error("Error:", error);
            document.getElementById("table").innerHTML =
              "Error loading contacts";
          });
      }

      document
        .getElementById("refresh")
        .addEventListener("click", fetchContacts);
      document.getElementById("addContact").addEventListener("click", () => {
        window.location.href = "add-contact.html";
      });
    </script>
  </body>
</html>
